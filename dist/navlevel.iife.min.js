(function(){"use strict";try{if(typeof document<"u"){var a=document.createElement("style");a.appendChild(document.createTextNode(".navlevel-popup[data-v-ce03094f]{position:relative}.navlevel-popup>div[data-v-ce03094f]{position:absolute;width:max-content;display:none;font-size:80%;top:0;left:0;background-color:var(--background-color, #ddd);border-radius:4px;padding:.5em;z-index:1;box-shadow:1px 1px 5px hsl(0 0 calc(100% * var(--rswiki-dark-mode-enabled, 0)))}li[data-v-3b5df835]:hover .navlevel-popup>div,li[data-v-3b5df835]:focus-within .navlevel-popup>div{display:block}.priority-sort[data-v-ca757e80]{display:flex;align-items:center;gap:var(--spacing-50, 8px);flex-wrap:wrap}.priority-chip[data-v-ca757e80]{display:inline-flex;align-items:center;padding:var(--spacing-25, 4px) var(--spacing-25, 4px);background-color:var(--background-color-base, #f8f9fa);border:1px solid var(--border-color-subtle, #c8ccd1);border-radius:var(--border-radius-base, 4px);color:var(--color-base, #202122);font-size:var(--font-size-small, .8125rem);font-weight:var(--font-weight-normal, 400);font-family:var(--font-family-system-sans, sans-serif);cursor:pointer;transition:all var(--transition-duration-base, .1s) var(--transition-timing-function-ease-in-out, ease-in-out);white-space:nowrap;-webkit-user-select:none;user-select:none}.priority-chip[data-v-ca757e80]:hover{background-color:var(--background-color-interactive-subtle, #eaecf0);border-color:var(--border-color-interactive, #72777d)}.priority-chip[data-v-ca757e80]:focus{outline:2px solid var(--color-progressive, #36c);outline-offset:2px}.priority-chip[data-v-ca757e80]:active{background-color:var(--background-color-interactive, #eaf3ff);border-color:var(--color-progressive, #36c)}.priority-arrow[data-v-ca757e80]{color:var(--color-subtle, #54595d);font-weight:var(--font-weight-bold, 700);margin:0 var(--spacing-25, 4px)}@media(max-width:768px){.priority-sort[data-v-ca757e80]{gap:var(--spacing-35, 6px)}.priority-arrow[data-v-ca757e80]{margin:0 var(--spacing-15, 2px)}}.navlevel-nav[data-v-cfb34bb3]{display:flex;flex-direction:row;flex-wrap:wrap;gap:.2em 1em}.navlevel-radio-group[data-v-cfb34bb3]{display:flex;flex-direction:row;align-items:center;flex-wrap:wrap;padding:2px}a[role=button][data-v-cfb34bb3]{cursor:pointer}.navlevel-sortable .navbox-title{z-index:1}.navbox.navlevel-sortable,.navlevel-sortable .navbox{overflow:visible!important}")),document.head.appendChild(a)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();

/// <reference types="types-mediawiki" />
/// <reference types="types-mediawiki-api" />
mw.loader.using(["vue", "@wikimedia/codex", "ext.gadget.HanAssist"], function(require) {
  const vueModule = require("vue");
  const codexModule = require("@wikimedia/codex");
  
  
  const Vue = vueModule;
  const Codex = codexModule;
  
  // ÂéüÂßã‰ª£Á†Å
  (function(){"use strict";const Z="rswiki:NavLevel-data",ce="rswiki:NavLevel-levels",pe="rswiki:NavLevel-difficulty",Q="rswiki:NavLevel-expiry",Ee="rswiki:NavLevel-options",Le="https://rs.miraheze.org/";async function ee(){const r=await new mw.Api().get({action:"cargoquery",formatversion:2,tables:"Level, Version",fields:"Level.name_zh = name, Level.num = num, Level._pageName = page, Level.type = type, Level.stars = stars, Level.first_came_version = inVer, Level.removed_version = remVer, Level.restored_version = resVer, Level.award = award, Level.diamonds = dia, Level.related_level = rel, Version.date = inDate",where:"Level.stars IS NOT NULL AND(Level.type = 'ÂÆòÊñπ' OR Level.type = 'ÂÖ±Âàõ') AND Level._pageName NOT LIKE '%ÔºàÊóßÔºâ'",join_on:"Level.first_came_version = Version._pageName",limit:500});if(!r.cargoquery)return null;const l=r.cargoquery.map(a=>({num:Number(a.title.num),stars:Number(a.title.stars),inVer:a.title.inVer,remVer:a.title.remVer,resVer:a.title.resVer,inDate:a.title.inDate,type:a.title.type,page:a.title.page,name:a.title.name,award:a.title.award,dia:Number(a.title.dia),rel:a.title.rel&&a.title.rel!==""?a.title.rel.split("„ÄÅ"):[]}));return l.length<210?null:l}async function We(){const r=localStorage.getItem(Z);let l;try{if(!r)throw new Error("No data");l=JSON.parse(r)}catch{}const a=localStorage.getItem(Q);if(a&&Number(a)&&Number(a)<Date.now()){console.log("Expired, fetching new data");const i=await ee();return i?(localStorage.setItem(Z,JSON.stringify(i)),localStorage.setItem(Q,String(Date.now()+432e5)),i):l}return l||(l=await ee(),l&&(localStorage.setItem(Z,JSON.stringify(l)),localStorage.setItem(Q,String(Date.now()+432e5))),l)}async function de(){const r=await fetch(Le+"wiki/Module:NavLevel/levels?action=raw");if(!r.ok)return null;const a=(await r.text()).replace(/^return\s+/,"").replace(/\{/g,"[").replace(/\}/g,"]").replace(/\-\-.*?\n/g,"");try{return JSON.parse(a)}catch{return null}}async function He(){let r=mw.storage.getObject(ce);return r||(r=await de(),mw.storage.setObject(ce,r,43200),r)}async function fe(){const r=await fetch(Le+"wiki/Module:Difficulty/data.json?action=raw");if(!r.ok)return null;const l=await r.text();try{return JSON.parse(l)}catch{return null}}async function Ge(){let r=mw.storage.getObject(pe);return r||(r=await fe(),mw.storage.setObject(pe,r,43200),r)}function Ze(r){mw.storage.setObject(Ee,r)}function Qe(){const r=mw.storage.getObject(Ee);return r||null}function ke(r){return mw.config.get("wgPageName").replace(/_/g," ")===r.replace(/_/g," ")}async function et(){const r=await de(),l=await ee(),a=await fe();return r&&mw.storage.setObject(ce,r,43200),a&&mw.storage.setObject(pe,a,43200),l&&(localStorage.setItem(Z,JSON.stringify(l)),localStorage.setItem(Q,String(Date.now()+432e5))),{levels:r,data:l,difficulty:a}}const xe=Object.freeze(Object.defineProperty({__proto__:null,fetchData:ee,fetchDifficulty:fe,fetchLevels:de,getData:We,getDifficulty:Ge,getValidLevels:He,hotPurge:et,isCurrentPage:ke,loadOptionsFromStorage:Qe,saveOptionsToStorage:Ze},Symbol.toStringTag,{value:"Module"}));let c;({convByVar:c}=require("ext.gadget.HanAssist"));const K=new Map;function tt(r){for(const l of r){const a=l.textContent.trim(),i=decodeURI(l.href.split("wiki/")[1]);K.set(i,a),K.set(a,a),K.set(i.replace(/_/g," "),a),K.set(a.replace(/_/g," "),a)}}function nt(r){return K.get(r)||r}function ot(r){return c({hans:"ÂÖ±Âàõ",hant:"ÂÖ±Ââµ"})}const De=mw.loader.getState("ext.gadget.separate-space")==="ready";function te(r){return De?" "+r+" ":r}function M(r){return De?r+" ":r}const rt=Vue.defineComponent,at=Vue.renderSlot,st=Vue.createElementVNode,lt=Vue.openBlock,it=Vue.createElementBlock,ut=Vue.nextTick,ct=Vue.onMounted,Ce=Vue.ref,pt=rt({__name:"Popup",props:{process:{type:Function}},setup(r){const l=r,a=Ce(null),i=Ce(null);return ct(async()=>{await ut();const p=i.value,v=p.getBoundingClientRect();v.right>window.innerWidth&&(p.style.top="100%",p.style.left=`${window.innerWidth-v.right-15}px`),v.y<window.innerHeight/2&&(p.style.bottom="100%",p.style.top="unset"),l.process(p)}),(p,v)=>(lt(),it("span",{class:"navlevel-popup",ref_key:"span",ref:a},[st("div",{ref_key:"div",ref:i},[at(p.$slots,"default",{},void 0,!0)],512)],512))}}),ne=(r,l)=>{const a=r.__vccOpts||r;for(const[i,p]of l)a[i]=p;return a},dt=ne(pt,[["__scopeId","data-v-ce03094f"]]),ft=Vue.defineComponent,vt=Vue.renderList,mt=Vue.Fragment,R=Vue.openBlock,q=Vue.createElementBlock,ve=Vue.unref,C=Vue.toDisplayString,gt=Vue.normalizeClass,ht=Vue.normalizeStyle,A=Vue.createElementVNode,oe=Vue.createTextVNode,yt=Vue.createCommentVNode,wt=Vue.withCtx,_t=Vue.createBlock,Vt={class:"hlist"},bt=["href","onMouseover","onTouchstart","onFocus","title"],Nt={style:{"font-weight":"bold"}},St={key:0,style:{"font-size":"120%"}},$t={key:1,style:{"font-size":"140%"}},Et=["href"];Vue.reactive;const Lt=Vue.ref,me=ne(ft({__name:"HList",props:{levels:{},usesMwNativePopup:{type:Boolean},showsBirthday:{type:Boolean},followsMain:{type:Boolean},processPopup:{type:Function}},setup(r){const l=ke;function a(m){return nt(m.page)}const i=Lt(null);function p(m){setTimeout(()=>i.value=m,200)}function v(m){const y=m.inDate;if(y.startsWith("?"))return!1;const s=Number(y.substring(5,7)),d=Number(y.substring(8,10)),h=new Date().toLocaleDateString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit"}),V=Number(h.substring(5,7)),D=Number(h.substring(8,10));return s===V&&d===D}function w(m){return m?m.toFixed?.(1)||m:"?.?"}function x(m){return m?m[2]?`${w(m[0])}/${w(m[1])}Ôºà${m[2]}Ôºâ`:`${w(m[0])}/${w(m[1])}`:"?.?/?.?"}return(m,y)=>(R(),q("ul",Vt,[(R(!0),q(mt,null,vt(r.levels,s=>(R(),q("li",null,[A("a",{href:ve(l)(s.page)?void 0:`/wiki/${encodeURI(s.page)}`,onMouseover:d=>p(s),onTouchstart:d=>p(s),onFocus:d=>p(s),class:gt(ve(l)(s.page)?"mw-selflink selflink":""),style:ht({fontWeight:r.followsMain&&s.main===s?"bold":""}),title:r.usesMwNativePopup?a(s):void 0},C(a(s))+C(r.showsBirthday&&v(s)?"üéÇ":""),47,bt),i.value===s?(R(),_t(dt,{key:0,process:d=>r.processPopup(s,d)},{default:wt(()=>[A("span",Nt,C(`${s.type==="ÂÆòÊñπ"?"Lv.":"Co."}${s.num} ${a(s)} ${"‚òÖ".repeat(s.stars)}`),1),y[1]||(y[1]=A("br",null,null,-1)),oe(" "+C(`${s.award==="crown"?"3üëë ":s.award==="present"?"10üéÅ ":""}${s.dia}üíé`)+" ",1),y[2]||(y[2]=A("br",null,null,-1)),Array.isArray(s.difficulty?.[0])?(R(),q("span",St,[oe(C(x(s.difficulty[0])),1),y[0]||(y[0]=A("br",null,null,-1)),oe(" "+C(x(s.difficulty[1])),1)])):(R(),q("span",$t,C(x(s.difficulty)),1)),y[3]||(y[3]=A("br",null,null,-1)),A("a",{href:"/wiki/"+s.inVer},C(s.inVer),9,Et),oe(C(`(${s.inDate||"????-??-??"})${ve(c)({hans:"ÁâàÊú¨Âä†ÂÖ•Ê∏∏Êàè",hant:"ÁâàÊú¨Âä†ÂÖ•ÈÅäÊà≤"})}`),1)]),_:2},1032,["process"])):yt("",!0)]))),256))]))}}),[["__scopeId","data-v-3b5df835"]]),kt=Vue.useModel,Oe=Vue.mergeModels,xt=Vue.defineComponent,Dt=Vue.renderList,Me=Vue.Fragment,re=Vue.openBlock,ae=Vue.createElementBlock,Ct=Vue.toDisplayString,Ot=Vue.createElementVNode,Mt=Vue.createCommentVNode,Bt={class:"priority-sort",role:"list","aria-label":"‰ºòÂÖàÁ∫ßÊéíÂ∫è"},Pt=["onClick","onKeydown","aria-label"],It={key:0,class:"priority-arrow","aria-hidden":"true"};Vue.computed;const ge=Vue.nextTick,At=ne(xt({__name:"PrioritySort",props:Oe({labelMap:{default:()=>({})}},{modelValue:{},modelModifiers:{}}),emits:Oe(["update:modelValue"],["update:modelValue"]),setup(r,{emit:l}){const a=r,i=kt(r,"modelValue"),p=l,v=d=>a.labelMap[d]||d,w=(d,f)=>{m(d.currentTarget,f),p("update:modelValue",i.value)},x=(d,f)=>{const h=d.currentTarget;switch(d.key){case"Enter":case" ":d.preventDefault(),m(h,f);break;case"ArrowLeft":d.preventDefault(),y(h,f);break;case"ArrowRight":d.preventDefault(),s(h,f);break}p("update:modelValue",i.value)},m=(d,f)=>{if(f<=0)return;const[h]=i.value.splice(f,1);i.value.unshift(h);const V=d.parentElement;ge(()=>{Array.from(V?.querySelectorAll(".priority-chip")||[])[0]?.focus()})},y=(d,f)=>{if(f<=0)return;const h=d.parentElement,V=i.value[f];i.value[f]=i.value[f-1],i.value[f-1]=V,ge(()=>{Array.from(h?.querySelectorAll(".priority-chip")||[])[f-1]?.focus()})},s=(d,f)=>{if(f>=i.value.length-1)return;const h=d.parentElement,V=i.value[f];i.value[f]=i.value[f+1],i.value[f+1]=V,ge(()=>{Array.from(h?.querySelectorAll(".priority-chip")||[])[f+1]?.focus()})};return(d,f)=>(re(),ae("div",Bt,[(re(!0),ae(Me,null,Dt(i.value,(h,V)=>(re(),ae(Me,{key:h},[Ot("button",{type:"button",class:"priority-chip",onClick:D=>w(D,V),onKeydown:D=>x(D,V),"aria-label":`${v(h)}ÔºåÁÇπÂáªËÆæ‰∏∫Á¨¨‰∏Ä‰ºòÂÖàÁ∫ßÔºåÂ∑¶Âè≥ÁÆ≠Â§¥ÈîÆÁßªÂä®‰∏Ä‰Ωç`},Ct(v(h)),41,Pt),V<i.value.length-1?(re(),ae("span",It,">")):Mt("",!0)],64))),128))]))}}),[["__scopeId","data-v-ca757e80"]]);function Be(r,l){return Object.keys(r).every(a=>l.hasOwnProperty(a))}function Tt(r,l,a,i,p){const v=[];if(window.NavLevel){if(window.NavLevel.Sorting&&window.NavLevel.sortingFunctions){if(!Be(window.NavLevel.sortingFunctions,window.NavLevel.Sorting))throw new Error("Sorting methods and functions do not match.");Object.assign(r,window.NavLevel.Sorting),Object.assign(l,window.NavLevel.sortingFunctions)}for(const w in r)a.includes(w)||a.push(w);if(window.NavLevel.Grouping&&window.NavLevel.groupingFunctions){if(!Be(window.NavLevel.groupingFunctions,window.NavLevel.Grouping))throw new Error("Grouping methods and functions do not match.");Object.assign(i,window.NavLevel.Grouping),Object.assign(p,window.NavLevel.groupingFunctions)}window.NavLevel.processPopup&&v.push(window.NavLevel.processPopup),console.log("Ê£ÄÊµãÂà∞window.NavLevelÔºåÂ∑≤ÂêàÂπ∂")}return window.NavLevel={Sorting:r,sortingFunctions:l,Grouping:i,groupingFunctions:p,set processPopup(w){v.push(w)}},(w,x)=>{v.forEach(m=>m(w,x))}}const Ft=Vue.defineComponent,N=Vue.createElementVNode,g=Vue.unref,S=Vue.toDisplayString,Pe=Vue.withModifiers,Ie=Vue.withKeys,L=Vue.createTextVNode,j=Vue.renderList,k=Vue.Fragment,_=Vue.openBlock,b=Vue.createElementBlock,Y=Vue.withCtx,Ae=Vue.createBlock,B=Vue.createVNode,he=Vue.normalizeClass,se=Vue.createCommentVNode,Rt={class:"navbox-above navbox-cell navbox-sole-row"},jt=["onKeydown"],Yt={class:"navbox-above navbox-cell navbox-sole-row navlevel-nav"},Ut={class:"navlevel-radio-group"},zt={class:"navlevel-radio-group"},Kt={class:"navlevel-radio-group"},qt={class:"navlevel-radio-group"},Xt={class:"navlevel-radio-group"},Jt={class:"navbox-group navbox-cell"},Wt=["title"],Ht={key:0,class:"navbox-group navbox-cell"},Gt=["title"],Zt={key:1,class:"navbox navbox-list navbox-cell navbox-level-1 mobileplainbox"},Qt={key:0,class:"navbox-group navbox-cell"},en=["title"],ye=Codex.CdxCheckbox,we=Codex.CdxRadio,tn=Vue.computed,nn=Vue.onBeforeUpdate,on=Vue.onMounted,Te=Vue.reactive,E=Vue.ref,Fe=Vue.watch,rn=ne(Ft({__name:"Main",props:{recvData:{},recvLevels:{},recvDifficulty:{},preserveElements:{},preserveBeforeElements:{},titleElement:{}},setup(r){const l=xe,{saveOptionsToStorage:a,loadOptionsFromStorage:i}=l,p=r,v=E(p.recvData),w=E(p.recvLevels),x=p.recvDifficulty;function m(t,e){for(const n of t){const o=n.page;n.difficulty=e[o]??[null,null]}return t}m(v.value,x);function y(t){const e={};for(const n of t)e[n.page]=n;e:for(const n of t){const o=n.rel;if(!o){n.main=n;continue}if(n.page==="Ê≤ôÊª©Ê¥æÂØπ"||n.page==="ÂçàÂ§úËø™ÊñØÁßë"){n.main=e.Ê≤ôÊª©Ê¥æÂØπ||n;continue}let u=n;if(n.page==="Ê†ºËµ´ÁΩóÊñØ")debugger;for(const G of o){const F=e[G];if(F){if(F.main){n.main=F.main;continue e}(F.inDate<u.inDate||F.inDate===u.inDate&&F.stars>u.stars)&&(u=F)}}n.main=u}}y(v.value),console.log(v.value.forEach(t=>console.log(t.page,t.main.page,t,t.main)));const s=Te({type:c({hans:"Á±ªÂûã",hant:"È°ûÂûã"}),era:c({hans:"Êó∂Êúü",hant:"ÊôÇÊúü"}),stars:c({hans:"ÊòüÊï∞",hant:"ÊòüÊï∏"}),version:c({hans:"ÁâàÊú¨",hant:"ÁâàÊú¨"}),present:c({hans:"Â•ñÂä±ÊñπÂºè",hant:"ÁçéÂãµÊñπÂºè"}),year:c({hans:"Âπ¥‰ªΩ",hant:"Âπ¥‰ªΩ"}),completeDifficulty:c({hans:"ÂÆåÊàêÈöæÂ∫¶",hant:"ÂÆåÊàêÈõ£Â∫¶"}),perfectDifficulty:c({hans:"ÂÆåÁæéÈöæÂ∫¶",hant:"ÂÆåÁæéÈõ£Â∫¶"}),none:c({hans:"Êó†",hant:"ÁÑ°"})});Fe(s,()=>{Promise.resolve().then(O)});const d=Te({num:c({hans:"ÁºñÂè∑",hant:"Á∑®Ëôü"}),name:c({hans:"ÂêçÁß∞",hant:"ÂêçÁ®±"}),stars:c({hans:"ÊòüÊï∞",hant:"ÊòüÊï∏"}),date:c({hans:"Êó•Êúü",hant:"Êó•Êúü"}),completeDifficulty:c({hans:"ÂÆåÊàêÈöæÂ∫¶",hant:"ÂÆåÊàêÈõ£Â∫¶"}),perfectDifficulty:c({hans:"ÂÆåÁæéÈöæÂ∫¶",hant:"ÂÆåÁæéÈõ£Â∫¶"}),default:c({hans:"ÈªòËÆ§",hant:"È†êË®≠"})});Fe(d,()=>{Promise.resolve().then(O)});const f={asc:"ÂçáÂ∫è",desc:"ÈôçÂ∫è"},h=i();function V(t){return t in d}function D(t){return t in f}const P=E(h?.grouping1??"type"),I=E(h?.grouping2??"stars"),Re=(t,e)=>t in s?t:e,le=E(h?.direction&&D(h.direction)?h.direction:"asc"),X=E(!1),U=E(h?.showsBirthday??!1),T=E(h?.followsMain??!1),je=new Set(["none","era","type"]),Ye=tn(()=>je.has(P.value)&&je.has(I.value)),Ue=["default","num","date","name","stars"],J=E(h?.sortingPriority??Ue),sn=t=>t.some(e=>!V(e))?Ue:(t.length!==Object.keys(d).length&&t.push(...Object.keys(d).filter(e=>!t.includes(e))),t),W=E(null),H=E(null),z=E({});on(()=>{if(H.value&&p.preserveBeforeElements?.length){let t=H.value;p.preserveBeforeElements.forEach(e=>{e&&t.parentNode&&(t.parentNode.insertBefore(e,t),t=e)})}if(W.value&&p.preserveElements?.length){let t=W.value;p.preserveElements.forEach(e=>{e&&t&&t.parentNode&&(t.parentNode.insertBefore(e,t.nextSibling),t=e)})}W.value&&W.value.remove(),H.value&&H.value.remove(),O()});function ln(t){return Xe[t]||(()=>0)}function ze(t,e){if(T.value&&Ye.value)if(t.main.page!==e.main.page)t=t.main,e=e.main;else return t.main.page===t.page?-1:e.main.page===e.page?1:t.main.rel.indexOf(t.page)-t.main.rel.indexOf(e.page);const n=sn(J.value);for(let o=0;o<n.length;o++){const u=ln(n[o])(t,e);if(u!==0)return u*(le.value==="asc"?1:-1)}return 0}function Ke(t,e){return Array.isArray(t)?t[e]:t}function ie(t,e){const n=t.difficulty,o=Ke(n[e],0);return o?typeof o=="string"?parseInt(o):Math.floor(o):t.stars}function ue(t,e){const n=t.difficulty,o=Ke(n[e],0);return o?typeof o=="string"?parseInt(o)-.01:o:t.stars-.01}const qe={era(t){return[{group:"Ëæ£Ê§í",list:t.filter(e=>e.type==="ÂÆòÊñπ"&&e.num<=7)},{group:c({hans:"ÁåéË±π",hant:"ÁçµË±π"}),list:t.filter(e=>e.type==="ÂÆòÊñπ"&&e.num>7&&e.num<=94)},{group:c({hans:"Á±≥È∫¶",hant:"Á±≥È∫•"}),list:t.filter(e=>e.type==="ÂÖ±Âàõ"||e.type==="ÂÆòÊñπ"&&e.num>94)}]},version(t){const e=new Set;return t.forEach(o=>e.add(o.inVer.substring(0,1))),e.has("2")&&e.delete("3"),Array.from(e).sort((o,u)=>o.localeCompare(u)).map(o=>({group:o==="2"?"2.x / 3.x":o+".x",list:o==="2"?t.filter(u=>u.inVer.startsWith("2")||u.inVer.startsWith("3")):t.filter(u=>u.inVer.startsWith(o))}))},type(t){return[{group:"ÂÆòÊñπ",list:t.filter(e=>e.type==="ÂÆòÊñπ")},{group:ot(),list:t.filter(e=>e.type==="ÂÖ±Âàõ")}]},stars(t){const e=new Set;return t.forEach(o=>e.add(o.stars)),Array.from(e).sort((o,u)=>o-u).map(o=>({group:M(o.toString())+"Êòü",list:t.filter(u=>u.stars===o)}))},year(t){const e=new Set;t.forEach(u=>e.add(u.inDate.substring(0,4)));const n=new Set;return e.forEach(u=>{u.trim()===""&&n.add(u)}),n.forEach(u=>e.delete(u)),Array.from(e).sort((u,G)=>parseInt(u)-parseInt(G)).map(u=>({group:u,list:t.filter(G=>G.inDate.startsWith(u))}))},present(t){const e=t.filter(o=>!["crown","present","none"].includes(o.award)),n=[{group:"ÁöáÂÜ†",list:t.filter(o=>o.award==="crown")},{group:"Á•ûÁßòÁÆ±",list:t.filter(o=>o.award==="present")},{group:c({hans:"Êó†",hant:"ÁÑ°"}),list:t.filter(o=>o.award==="none")}];return e.length>0&&n.push({group:c({hans:"Êú™Áü•",hant:"Êú™Áü•"}),list:e}),n},completeDifficulty(t){const e=new Set;for(const n of t)e.add(ie(n,0));return Array.from(e).sort((n,o)=>n-o).map(n=>({group:n+".x",list:t.filter(o=>ie(o,0)===n)}))},perfectDifficulty(t){const e=new Set;for(const n of t)e.add(ie(n,1));return Array.from(e).sort((n,o)=>n-o).map(n=>({group:n+".x",list:t.filter(o=>ie(o,1)===n)}))},none(t){return t}},Xe={num:(t,e)=>t.type===e.type?t.num-e.num:t.type==="ÂÆòÊñπ"?-1:1,name:(t,e)=>t.name.localeCompare(e.name),stars:(t,e)=>t.stars-e.stars,date:(t,e)=>t.inDate.localeCompare(e.inDate),completeDifficulty:(t,e)=>ue(t,0)-ue(e,0),perfectDifficulty:(t,e)=>ue(t,1)-ue(e,1),default:(t,e)=>{const n=w.value;return n.indexOf(t.page)-n.indexOf(e.page)}},_e=Tt(d,Xe,J.value,s,qe);function un(t,e){return qe[e](t)}function Ve(t,e){return un(t,e).map(n=>(n.list=n.list.sort(ze),n))}let Je=0;const cn=()=>{Je=0};function be(){a({grouping1:P.value,grouping2:I.value,sortingPriority:J.value,direction:le.value,showsBirthday:U.value,followsMain:T.value})}function O(){console.log("Sorting...");const t=Re(P.value,"type");let e=Re(I.value,"stars");t===e&&e!=="none"&&(I.value=e=t==="stars"?"type":"stars"),t==="none"&&(I.value="none"),be();const n=v.value;if(t==="none"){z.value=[...n].sort(ze);return}else e==="none"?z.value=Ve(n,t):z.value=Ve(n,t).map(o=>(o.list=Ve(o.list,e),o))}function Ne(){return++Je%2?"navbox-odd":"navbox-even"}async function Se(){const{levels:t,data:e,difficulty:n}=await l.hotPurge();t?w.value=t:mw.notify(c({hans:"Ëé∑ÂèñÂêàÊ≥ïÂÖ≥Âç°ÂàóË°®Â§±Ë¥•„ÄÇ",hant:"Áç≤ÂèñÂêàÊ≥ïÈóúÂç°ÂàóË°®Â§±Êïó„ÄÇ"}),{type:"error"}),e?(v.value=m(e,n),y(v.value)):mw.notify(c({hans:`Ëé∑ÂèñÂÖ≥Âç°${te("Cargo")}Êï∞ÊçÆÂ§±Ë¥•„ÄÇ`,hant:`Áç≤ÂèñÈóúÂç°${te("Cargo")}Êï∏ÊìöÂ§±Êïó„ÄÇ`}),{type:"error"}),(t||e)&&mw?.notify?.(c({hans:`Êï∞ÊçÆÂ∑≤Êõ¥Êñ∞„ÄÇ${M(v.value.length)}Êù°Êï∞ÊçÆËÆ∞ÂΩïÔºå${M(w.value.length)}‰∏™ÂÖ≥Âç°„ÄÇ`,hant:`Êï∏ÊìöÂ∑≤Êõ¥Êñ∞„ÄÇ${M(v.value.length)}Ê¢ùÊï∏ÊìöË®òÈåÑÔºå${M(w.value.length)}ÂÄãÈóúÂç°„ÄÇ`})),O()}nn(()=>{cn()});const $e=c({hans:"ÂÖ≥",hant:"Èóú"});return(t,e)=>(_(),b(k,null,[N("div",{ref_key:"markerBefore",ref:H},null,512),N("div",Rt,[L(S(g(c)({hans:`Êú¨Êô∫ËÉΩÊéíÂ∫è‰∏∫ÂÆûÈ™åÊÄßÂäüËÉΩ„ÄÇÂΩìÂâçËé∑ÂèñÂà∞${g(te)(v.value.length)}‰∏™ÂÖ≥Âç°ÁöÑÊï∞ÊçÆ„ÄÇ`,hant:`Êú¨Êô∫ËÉΩÊéíÂ∫èÁÇ∫ÂØ¶È©óÊÄßÂäüËÉΩ„ÄÇÁï∂ÂâçÁç≤ÂèñÂà∞${g(te)(v.value.length)}ÂÄãÈóúÂç°ÁöÑÊï∏Êìö„ÄÇ`}))+" Ôºà",1),N("a",{onClick:Se,onKeydown:[Ie(Pe(Se,["prevent"]),["enter"]),Ie(Pe(Se,["prevent"]),["space"])],role:"button",tabindex:"0"},S(g(c)({hans:"Ê∏ÖÈô§ÁºìÂ≠ò",hant:"Ê∏ÖÈô§Âø´Âèñ"})),41,jt),e[10]||(e[10]=L("Ôºâ ",-1))]),N("div",Yt,[N("div",Ut,[L(S(g(c)({hans:"‰∏ÄÁ∫ßÂàÜÁªÑÔºö",hant:"‰∏ÄÁ¥öÂàÜÁµÑÔºö"}))+" ",1),(_(!0),b(k,null,j(s,(n,o)=>(_(),Ae(g(we),{"model-value":P.value,"onUpdate:modelValue":[e[0]||(e[0]=u=>P.value=u),O],"input-value":o,name:"grouping1",inline:!0},{default:Y(()=>[L(S(s[o]),1)]),_:2},1032,["model-value","input-value"]))),256))]),N("div",zt,[L(S(g(c)({hans:"‰∫åÁ∫ßÂàÜÁªÑÔºö",hant:"‰∫åÁ¥öÂàÜÁµÑÔºö"}))+" ",1),(_(!0),b(k,null,j(s,(n,o)=>(_(),Ae(g(we),{"model-value":I.value,"onUpdate:modelValue":[e[1]||(e[1]=u=>I.value=u),O],"input-value":o,name:"grouping2",inline:!0,disabled:o!==P.value==(P.value==="none")},{default:Y(()=>[L(S(s[o]),1)]),_:2},1032,["model-value","input-value","disabled"]))),256))]),N("div",Kt,[L(S(g(c)({hans:"ÊéíÂ∫èÔºö",hant:"ÊéíÂ∫èÔºö"}))+" ",1),B(At,{modelValue:J.value,"onUpdate:modelValue":[e[2]||(e[2]=n=>J.value=n),e[3]||(e[3]=n=>O())],"label-map":d},null,8,["modelValue","label-map"])]),N("div",qt,[(_(),b(k,null,j(f,(n,o)=>B(g(we),{name:"direction","input-value":o,"model-value":le.value,"onUpdate:modelValue":[e[4]||(e[4]=u=>le.value=u),O],inline:!0},{default:Y(()=>[L(S(f[o]),1)]),_:2},1032,["input-value","model-value"])),64))]),N("div",Xt,[B(g(ye),{inline:!0,"model-value":X.value,"onUpdate:modelValue":e[5]||(e[5]=n=>X.value=n)},{default:Y(()=>[L(S(g(c)({hans:"ÊòæÁ§∫MediaWikiÂéüÁîüÂºπÂá∫Ê°Ü",hant:"È°ØÁ§∫MediaWikiÂéüÁîüÂΩàÂá∫Ê°Ü"})),1)]),_:1},8,["model-value"]),B(g(ye),{inline:!0,"model-value":U.value,"onUpdate:modelValue":[e[6]||(e[6]=n=>U.value=n),e[7]||(e[7]=n=>be())]},{default:Y(()=>[L(S(g(c)({hans:"Ê†áËÆ∞ÁîüÊó•Âú®‰ªäÊó•ÔºàUTC+8ÔºâÁöÑÂÖ≥Âç°",hant:"Ê®ôË®òÁîüÊó•Âú®‰ªäÊó•ÔºàÊåâUTC+8ÔºâÁöÑÈóúÂç°"})),1)]),_:1},8,["model-value"]),B(g(ye),{inline:!0,"model-value":T.value,"onUpdate:modelValue":[e[8]||(e[8]=n=>T.value=n),e[9]||(e[9]=n=>{be(),O()})]},{default:Y(()=>[L(S(Ye.value?g(c)({hans:"ÁªëÂÆöÂêåÊóèÂÖ≥Âç°",hant:"Á∂ÅÂÆöÂêåÊóèÈóúÂç°"}):g(c)({hans:"È´ò‰∫Æ‰∏ªÁ∫øÔºàÂõ∞ÈöæÔºâÂÖ≥Âç°",hant:"È´ò‰∫Æ‰∏ªÁ∑öÔºàÂõ∞Èõ£ÔºâÈóúÂç°"})),1)]),_:1},8,["model-value"])])]),P.value==="none"?(_(),b("div",{key:0,class:he("navbox-list navbox-sole-row "+Ne())},[B(me,{levels:z.value,"uses-mw-native-popup":X.value,"shows-birthday":U.value,"process-popup":g(_e),"follows-main":T.value},null,8,["levels","uses-mw-native-popup","shows-birthday","process-popup","follows-main"])],2)):(_(),b(k,{key:1},[I.value==="none"?(_(!0),b(k,{key:0},j(z.value,n=>(_(),b(k,null,[N("div",Jt,[N("span",{class:"navbox-group-flex-inner",title:`${g(M)(n.list.length)}${g($e)}`},S(n.group),9,Wt)]),N("div",{class:he("navbox-list navbox-cell "+Ne())},[B(me,{levels:n.list,"uses-mw-native-popup":X.value,"shows-birthday":U.value,"process-popup":g(_e),followsMain:T.value},null,8,["levels","uses-mw-native-popup","shows-birthday","process-popup","followsMain"])],2)],64))),256)):(_(!0),b(k,{key:1},j(z.value,n=>(_(),b(k,null,[n.list.length>0?(_(),b("div",Ht,[N("span",{class:"navbox-group-flex-inner",title:`${g(M)(n.list.reduce((o,u)=>o+u.list.length,0))}${g($e)}`},S(n.group),9,Gt)])):se("",!0),n.list.length>0?(_(),b("div",Zt,[(_(!0),b(k,null,j(n.list,o=>(_(),b(k,null,[o.list.length>0?(_(),b("div",Qt,[N("span",{class:"navbox-group-flex-inner",title:`${g(M)(o.list.length)}${g($e)}`},S(o.group),9,en)])):se("",!0),o.list.length>0?(_(),b("div",{key:1,class:he("navbox-list navbox-cell "+Ne())},[B(me,{levels:o.list,"uses-mw-native-popup":X.value,"shows-birthday":U.value,"process-popup":g(_e),followsMain:T.value},null,8,["levels","uses-mw-native-popup","shows-birthday","process-popup","followsMain"])],2)):se("",!0)],64))),256))])):se("",!0)],64))),256))],64)),N("div",{ref_key:"mark",ref:W},null,512)],64))}}),[["__scopeId","data-v-cfb34bb3"]]);async function an(){const r=xe,{getData:l,getValidLevels:a,getDifficulty:i}=r;try{const[p,v,w]=await Promise.all([l(),a(),i()]);if(!p||!v){mw.notify("Failed to fetch qualified data",{type:"error"});return}const x=document.querySelectorAll(".navlevel-sortable:not(.navlevel-sortable-processed)");$.each(x,async(m,y)=>{tt(Array.from(y.querySelectorAll("a[href]")));const s=Array.from(y.querySelectorAll(".navlevel-sortable-preserve")),d=Array.from(y.querySelectorAll(".navlevel-sortable-preserve-before"));[...s,...d].forEach(V=>{V.parentNode&&V.parentNode.removeChild(V)});const f=$(y);f.empty(),f.addClass("navlevel-sortable-processed"),Vue.createApp(rn,{recvData:p,recvLevels:v,recvDifficulty:w,preserveElements:s,preserveBeforeElements:d,titleElement:y.querySelector(".navbox-title")||document.createElement("div")}).mount(y)})}catch(p){console.error("Failed to initialize NavLevel:",p),mw.notify("Failed to initialize NavLevel: "+p.message,{type:"error"})}}mw.hook("wikipage.content").add(an)})();

  
});
